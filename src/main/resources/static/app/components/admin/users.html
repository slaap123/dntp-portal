<div class="page-header">
    <h2>{{'Users'|translate}}</h2>
</div>
<div ng-show="!authenticated">
<div class="alert alert-danger" role="alert">
    {{'Not logged in'|translate}}.
</div>
</div>

<div ng-if="authenticated">

<div ng-controller="UserController" class="container">

	<div class="alert alert-danger" role="alert" ng-show="error.length" id="error">
	    {{error|translate}}.
	</div>

<div ng-hide="error">

    <form class="form-horizontal" role="form" ng-submit="add(user)">
    
    <div class="input-group">
        <input ng-model="user.username" />
        <span class="input-group-btn pull-right">
            <button class="btn btn-info" type="submit" title="Add user">
                <span class="glyphicon glyphicon-plus"></span> add user
            </button>
        </span>
    </div>

    </form>

    <p></p>

    <div class="alert alert-info" role="alert" ng-hide="users.length">
        There are no users yet.
    </div>

    <ul class="list-group">
    <li class="list-group-item {{visibility[user.id] ? 'list-group-item-info' : ''}}" ng-repeat="user in users" id="user_{{user.id}}">
        <h4 class="list-group-item-heading" ng-click="toggleVisibility(user)">
            <label>User {{user.id}}: {{user.username}}</label>
            
            (<em>roles: </em><span ng-repeat="role in user.roles">{{role.name}}{{$last ? '' : ', '}}</span>)
	        <span class="pull-right">
	        <span class="btn-group">
                <button class="btn btn-default" type="button" title="{{visibility[user.id] ? 'Collapse' :'Roles'}}">
                <span class="glyphicon {{visibility[user.id] ? 'glyphicon-menu-up' :'glyphicon-menu-down'}}"></span>
                </button>
                <button class="btn btn-default {{user.active ? 'disabled' : ''}}" type="button" title="Activate"
                    ng-click="activate(user)">
                    Activate
                </button>
                <button class="btn btn-default {{user.active ? '' : 'disabled'}}" type="button" title="Dectivate"
                    ng-click="deactivate(user)">
                    Deactivate
                </button>
				<button class="btn btn-default" type="button" title="Remove"
	                ng-click="remove(user)">
	            <span class="glyphicon glyphicon-trash"></span>
		        </button>
	        </span>
	        </span>
        </h4>
        <p ng-show="visibility[user.id]">
            Edit user roles:
            <ul class="list-group" ng-show="visibility[user.id]">
            <li class="list-group-item" ng-repeat="role in roles">
                <input type="checkbox" id="userRoles[{{user.id}}][{{role.id}}]"
                ng-model="userRoles[user.id][role.id]" ng-change="updateRole(user, role)" />
                <label for="userRoles[{{user.id}}][{{role.id}}]">{{role.name}}</label>
            </li>
            </ul>
        </p>
    </li>
    </ul>
    
</div>    
    
</div>
    
    
</div>